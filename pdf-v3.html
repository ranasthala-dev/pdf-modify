<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap"
        rel="stylesheet">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap"
        rel="stylesheet">


    <title>Document</title>
    <style>
        /* layout */
        html,
        body {
            /* display: flex; */
            height: 100%;
            width: 100%;
            margin: 0;
            padding: 0;
            background-color: #F7F7F7;
            font-family: "Roboto", sans-serif;
            font-size: 16px;
            color: #4d4e55;
        }

        *,
        *::before,
        *::after {
            box-sizing: border-box;
        }

        li,
        ul,
        a {
            text-decoration: none;
            padding: 0;
            margin: 0;
        }




        .container {
            display: flex;
            padding: 10px;
            height: 100%;
            width: 100%;
        }

        .nav {
            background-color: #F7F7F7;
            padding-top: 10px;
            padding-bottom: 10px;
            width: 200px;
            display: flex;
            flex-direction: column;
        }

        .main-container {
            height: 100%;
            width: 100%;
            padding: 10px;
        }

        .main {
            display: flex;
            flex-direction: column;
            height: 100%;
            width: 100%;
            background-color: #FFFDFC;
            border: 0.7px solid #ece8e8;
            /* border: 0.7px solid rgb(5, 6, 45); */
            border-radius: 10px;
        }

        .logo {
            font-size: 20px;
        }

        .nav ul li {
            padding-left: 25px;
            padding-top: 20px;
        }

        .bx {
            padding-right: 10px;
        }

        .methods {
            padding: 5px;
            text-align: left;
            width: 100%;
            color: #4d4e55;
            border: none;
            border: 0.7px solid transparent;
            background-color: #F7F7F7;
            border-radius: 10px;
            font-weight: bold;
        }

        .methods:hover {
            background-color: #FFFDFC;
            border: 0.7px solid #ece8e8;
        }

        /* From Uiverse.io by cssbuttons-io */
        .methods {
            align-items: center;
            /* background-image: linear-gradient(144deg, #af40ff, #5b42f3 50%, #00ddeb); */
            background-image: linear-gradient(144deg, #131213, #1e70db 50%, #150232);
            border-radius: 8px;
            box-shadow: rgba(149, 107, 197, 0.2) 0 15px 30px -5px;
            box-sizing: border-box;
            color: #ffffff;
            display: flex;
            /* font-size: 18px; */
            justify-content: center;
            /* line-height: 1em; */
            max-width: 100%;
            /* min-width: 140px; */
            text-decoration: none;
            user-select: none;
            -webkit-user-select: none;
            touch-action: manipulation;
            white-space: nowrap;
            cursor: pointer;
            transition: all 0.3s;
        }

        .methods:active,
        .methods:hover {
            outline: 0;
        }

        .methods span {
            background-color: rgb(5, 6, 45);
            border-radius: 6px;
            padding: 5px;
            width: 100%;
            height: 100%;
            transition: 300ms;
        }

        .methods:hover span {
            background: none;
        }

        .methods:active {
            transform: scale(0.9);
            /* Shrink shadow too */
        }

        /* end */

        .git {
            display: flex;
            /* justify-content: center; */
            align-items: center;
            margin-top: auto;
            height: 10%;
            width: 100%;
            background-color: #FFFDFC;
            border: 0.7px solid #ece8e8;
            /* border: 0.7px solid rgb(5, 6, 45); */

            border-radius: 10px;
            padding-left: 5px;
        }

        .pic {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            /* border: 1px solid rgb(5, 6, 45); */
        }

        .git-name {
            padding-left: 6px;
            color: rgb(5, 6, 45);
            font-weight: bold;

        }

        /* main body */

        /* nav bar */
        .nav-bar {
            display: flex;
            width: 100%;
            justify-content: flex-end;
            /* Push content to right */
            align-items: end;
        }

        .nav-list {
            display: flex;
            gap: 20px;
            width: 100%;
            justify-content: flex-end;
            list-style: none;
            margin: 0;
            padding: 10px 20px;
            /* background-color: #1e70db; */
            border-radius: 10px 10px 0 0;
        }

        .nav-button {
            border: none;
            color: rgb(5, 6, 45);
            background-color: #FFFDFC;
            font-weight: bold;
            padding: 5px;
            cursor: pointer;
            /* transition: 0.3s; */

        }

        .nav-button:hover {
            background-color: rgb(5, 6, 45);
            color: #FFFDFC;
            border-radius: 8px;
        }


        .nav-button :active,
        .nav-button :hover {
            outline: 0;
        }

        .nav-button:active {
            transform: scale(0.9);
        }


        /* uploads */

        /* vertical - preview */

        .uploads-container {
            height: 100%;
            width: 100%;
        }

        .view {
            display: none;
        }

        .vertical-preview {
            display: block;
            /* default */
        }


        .vertical-preview {
            height: 100%;
            width: 100%;

        }

        .uploads {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
            width: 100%;
        }

        .upload-box1 {
            display: flex;
            height: 100%;
            padding-top: 25px;
            padding-bottom: 50px;

        }

        .upload-box2 {
            display: flex;
            height: 100%;
            padding-top: 25px;
            padding-bottom: 50px;
        }

        #file1 {
            display: none;
        }

        #file2 {
            display: none;
        }

        .round-upload {
            width: 40px;
            height: 40px;
            margin: 10px;
            /* background: linear-gradient(135deg, #6a11cb, #00050e); */
            background: linear-gradient(135deg, #1e70db, rgb(5, 6, 45));

            color: white;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 32px;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            transition: transform 0.2s ease;
        }

        .round-upload:hover {
            transform: scale(1.1);
        }

        .vertical-preview-box {
            width: 400px;
            padding: 16px;
            overflow-y: scroll;
            overflow-x: hidden;
            /* border: 1px solid rgb(196, 192, 192); */
            /* border: 1px solid rgb(196, 192, 192); */
            border: 0.7px solid #ece8e8;
            background-color: #f1f1f1;
            border-radius: 7px;
            height: 100%
                /* border-right: 1px solid #ccc; */
        }

        /* notfication */
        .notification {
            position: fixed;
            bottom: 50px;
            right: 50px;
            background-color: #323232;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            opacity: 0;
            transition: opacity 0.5s ease;
            z-index: 9999;
        }

        .notification.show {
            opacity: 1;
        }

        canvas {
            border: 1px solid #ccc;
            cursor: pointer;
            position: relative;
        }

        .selected {
            outline: 3px solid #007bff;
        }

        .selection-badge {
            position: absolute;
            background: #007bff;
            color: white;
            font-size: 14px;
            padding: 2px 6px;
            border-radius: 50%;
            top: 8px;
            left: 8px;
            z-index: 10;
        }

        .canvas-wrapper {
            position: relative;
            display: inline-block;
        }

        .docs-container {
            display: flex;
            /* justify-content: center; */
            align-items: center;
            flex-direction: column;
        }



        .docs-inner {
            border: 0.7px solid #ece8e8;
            /* background-color: #f1f1f1; */
            background-color: #FFFDFC;

            border-radius: 7px;
            padding: 20px;
            width: 80%;
        }

        .docs-box {
            display: flex;

        }
    </style>
</head>

<body>
    <div class="container">
        <div class="nav">
            <div class="logo">
                <i class='bx bx-menu' id="btn"></i>
                <span>PDF - Modify</span>
            </div>

            <ul>
                <li><button class="methods"><span><i class='bx bx-merge'></i>Merge</span></button></li>
                <li><button class="methods"> <span><i class='bx bx-plus'></i>Add</span></button></li>
                <li><button class="methods"><span><i class='bx bx-cut'></i>Extract</span></button></li>
                <li><button class="methods"> <span><i class='bx bx-trash'></i>Remove</span></button></li>
                <li><button class="methods"><span><i class='bx bx-shuffle'></i>Shuffle</span></button></li>

            </ul>
            <div class="git">
                <!-- <img class="pic" src="me.jpeg" alt="git" width="50px" height="50px"> -->
                <img class="pic" src="user.png" alt="git" width="50px" height="50px">

                <a href="" class="git-name">ranasthala-dev</a>
            </div>

        </div>
        <div class="main-container">

            <div class="main">
                <div class="nav-bar">
                    <ul class="nav-list">
                        <li><button class="nav-button" id="nav-shuffle">go-shuffle</button></li>
                        <li><button class="nav-button" id="nav-docs">docs</button></li>
                    </ul>
                </div>
                <div class="uploads-container">
                    <div class="view vertical-preview">
                        <div class="uploads">
                            <div class="upload-box1 upload-box">
                                <div class="upload-btn1">
                                    <input type="file" id="file1" accept="application/pdf" />
                                    <label for="file1" class="round-upload" title="Upload PDF">+</label>
                                </div>
                                <div class="vertical-preview-box" id="pdf-preview-1"></div>
                            </div>
                            <div class="upload-box2 upload-box">
                                <div class="upload-btn2">
                                    <input type="file" id="file2" accept="application/pdf" />
                                    <label for="file2" class="round-upload" title="Upload PDF">+</label>
                                </div>
                                <div class="vertical-preview-box" id="pdf-preview-2"></div>
                            </div>
                        </div>
                    </div>
                    <div class="view horiontal-preview">
                        hii
                    </div>
                    <div class="view docs-view">
                        <div class="docs-container">
                            <div class="docs-inner">
                                <div><b>Merge</b></div><br>
                                <div class="docs-box">
                                    <div class="description">
                                        Upload the PDFs in their respective slots — the second PDF will always
                                        be
                                        appended to the first.<br><br>

                                        Selections will not affect the merge process. To maintain
                                        simplicity and clarity in functionality, merging has been intentionally
                                        designed to combine PDFs in a fixed order — with all appended content
                                        added
                                        at the end.<br><br>

                                        This approach ensures consistent results and an intuitive experience.
                                    </div>
                                    <!-- <img src="image.png" class="docs-img" alt="" width="60%" height="100%"> -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- pdf.js CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
    <!-- pdf-lib CDN -->
    <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>

    <script>
        // toggle view -----------
        const views = {
            home: document.querySelector(".vertical-preview"),
            shuffle: document.querySelector(".horiontal-preview"),
            docs: document.querySelector(".docs-view")
        };

        const navBtn = document.getElementById("nav-shuffle");

        function showView(viewKey) {
            Object.values(views).forEach(v => v.style.display = "none");
            views[viewKey].style.display = "block";

            // Optional: change text on shuffle button
            navBtn.textContent = viewKey === "home" ? "go-shuffle" : "home";
        }

        // Initial view
        showView("home");

        // Event listeners
        navBtn.addEventListener("click", () => {
            const isHome = views["home"].style.display === "block";
            showView(isHome ? "shuffle" : "home");
        });

        document.getElementById("nav-docs").addEventListener("click", () => showView("docs"));

        // notify ---------
        function showNotification(message, duration = 2000) {
            const notif = document.createElement('div');
            notif.className = 'notification';
            notif.textContent = message;
            document.body.appendChild(notif);

            // Trigger animation
            requestAnimationFrame(() => notif.classList.add('show'));

            // Remove after duration
            setTimeout(() => {
                notif.classList.remove('show');
                setTimeout(() => notif.remove(), 500); // wait for fade out
            }, duration);
        }

        // <!-- preview  -->
        const file1Input = document.getElementById('file1');
        const file2Input = document.getElementById('file2');
        const preview1 = document.getElementById('pdf-preview-1');
        const preview2 = document.getElementById('pdf-preview-2');

        let pdf1Selected = [];
        let pdf2Selected = [];
        let uploadedFile1 = null;
        let uploadedFile2 = null;

        file1Input.addEventListener('change', () => {
            pdf1Selected = [];
            uploadedFile1 = file1Input.files[0]; // <-- Save file here
            renderPDF(uploadedFile1, preview1, pdf1Selected, 'pdf1');
        });

        file2Input.addEventListener('change', () => {
            pdf2Selected = [];
            uploadedFile2 = file2Input.files[0]; // <-- Save file here
            renderPDF(uploadedFile2, preview2, pdf2Selected, 'pdf2');
        });
        async function renderPDF(file, container, selectionArray, tag) {
            container.innerHTML = '';
            const arrayBuffer = await file.arrayBuffer();
            const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;

            for (let pageNum = 1; pageNum <= pdf.numPages; pageNum++) {
                const page = await pdf.getPage(pageNum);
                const viewport = page.getViewport({ scale: 0.6 });
                const canvas = document.createElement('canvas');
                canvas.setAttribute('data-page', pageNum);
                canvas.setAttribute('data-tag', tag);

                const context = canvas.getContext('2d');
                canvas.height = viewport.height;
                canvas.width = viewport.width;

                await page.render({ canvasContext: context, viewport }).promise;

                const wrapper = document.createElement('div');
                wrapper.classList.add('canvas-wrapper');
                wrapper.appendChild(canvas);
                container.appendChild(wrapper);

                canvas.addEventListener('click', () => {
                    const pageId = parseInt(canvas.dataset.page);
                    const list = tag === 'pdf1' ? pdf1Selected : pdf2Selected;

                    const index = list.indexOf(pageId);
                    if (index !== -1) {
                        list.splice(index, 1);
                        canvas.classList.remove('selected');
                    } else {
                        list.push(pageId);
                        canvas.classList.add('selected');
                    }

                    updateBadges(container, list);
                });
            }
        }
        function updateBadges(container, list) {
            const wrappers = container.querySelectorAll('.canvas-wrapper');
            wrappers.forEach(wrapper => {
                const badge = wrapper.querySelector('.selection-badge');
                if (badge) badge.remove();

                const canvas = wrapper.querySelector('canvas');
                const pageId = parseInt(canvas.dataset.page);
                const index = list.indexOf(pageId);
                if (index !== -1) {
                    const badge = document.createElement('div');
                    badge.classList.add('selection-badge');
                    badge.textContent = index + 1;
                    wrapper.appendChild(badge);
                }
            });
        }

        function logSelections() {
            console.log('pdf1:', pdf1Selected);
            console.log('pdf2:', pdf2Selected);
        }
    </script>
</body>

</html>